<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <title>Best in Travel-Route Detail</title>
    <link rel="stylesheet" type="text/css" href="css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="css/common.css">
    <link rel="stylesheet" type="text/css" href="css/route-detail.css">
    <script src="js/getParameter.js"></script>
</head>

<body>
<!--import header-->
<div id="header"></div>
    <!-- 详情 start -->   
    <div class="wrap">
        <div class="bread_box">
            <a href="index.html">Home</a>
            <span> &gt;</span>
            <a href="#" id="cname">国内游</a><span> &gt;</span>
            <a href="#" id="intro_title">全国-曼谷6-7天自由行 泰国出境旅游 特价往返机票自由行二次确认</a>
        </div>
        <div class="prosum_box">
            <dl class="prosum_left">
                <dt>
                    <img alt="" class="big_img" src="http://www.jinmalvyou.com/Public/uploads/goods_img/img_size4/201703/m49788843d72171643297ccc033d9288ee.jpg">
                </dt>
                <dd id="carousel">
                    <a class="up_img up_img_disable"></a>
                    <a title="" class="little_img" data-bigpic="http://www.jinmalvyou.com/Public/uploads/goods_img/img_size4/201703/m40920d0669855e745d97f9ad1df966ebb.jpg">
                        <img src="http://www.jinmalvyou.com/Public/uploads/goods_img/img_size2/201703/m20920d0669855e745d97f9ad1df966ebb.jpg">
                    </a>
                    <a title="" class="little_img" data-bigpic="http://www.jinmalvyou.com/Public/uploads/goods_img/img_size4/201703/m467db00e1b76718fab0fe8b96e10f4d35.jpg" style="display:none;">
                        <img src="http://www.jinmalvyou.com/Public/uploads/goods_img/img_size2/201703/m267db00e1b76718fab0fe8b96e10f4d35.jpg">
                    </a>
                    <a title="" class="little_img" data-bigpic="http://www.jinmalvyou.com/Public/uploads/goods_img/img_size4/201703/m487bbbc6e43eba6aa6a36cc1a182f7a20.jpg" style="display:none;">
                        <img src="http://www.jinmalvyou.com/Public/uploads/goods_img/img_size2/201703/m287bbbc6e43eba6aa6a36cc1a182f7a20.jpg">
                    </a>
                    <a class="down_img down_img_disable" style="margin-bottom: 0;"></a>
                </dd>
            </dl>
            <div class="prosum_right">
               <p class="pros_title" id="rname">【尾单特卖】全国-曼谷6-7天自由行 泰国出境旅游 特价往返机票自由行二次确认</p>
                <p class="hot" id="routeIntroduce">1-2月出发，网付立享￥1099/2人起！爆款位置有限，抢完即止！</p>
                <div class="pros_other">
                    <p>Seller: <span id="sname">DTS</span></p>
                    <p>Phone: <span  id="consphone">2177777777</span></p>
                    <p>Address: <span  id="address">Chicago, IL</span></p>
                </div>
                <div class="pros_price">
                    <p class="price"><strong id="price">¥2699.00</strong><span>起</span></p>
                    <p class="collect">
                        <a class="btn" id="favorite" onclick="addFavorite();"><i class="glyphicon glyphicon-heart-empty"></i><span id="addText">已收藏</span></a>

                        <!--<a  class="btn already" disabled="disabled"><i class="glyphicon glyphicon-heart-empty"></i>点击收藏</a>-->
                        <span id="favCount">已收藏100次</span>
                    </p>
                </div>        
            </div>
        </div>
        <div class="you_need_konw">
            <span><b>Terms & Conditions</b></span>
            <div class="notice">
                <p><b>PLEASE READ THIS.  IT CONSTITUTES PART OF YOUR CONTRACT FOR YOUR TRIP AND ANY RELATED SERVICES.  PLEASE CALL US IMMEDIATELY IF YOU HAVE ANY QUESTIONS. </b></p>

                <p><i><u>BOOKING ACCURACY/LEGAL NAMES:</u></i>  Passenger is required to immediately review all aspects of their booking to verify (but not limited to): passenger names, mailing address, email address, telephone number, date of birth, pricing, airfare, arrival/departure airports, accommodations, and organized activities on your booking receipt. Please notify BIT immediately if any omissions and/or corrections are needed regarding the booking details. Passenger(s) voluntarily assumes full & sole responsibility for any and all risks and/or costs involved with failure to report such errors and/or omissions. Passenger is required to verify the accuracy of the passenger’s LEGAL first & last names. It is mandatory that guest names be identical to the Passenger(s) LEGAL first and last names and identical to the names as they appear on booking and travel documents.</p>

                <p><i><u>TRAVEL DOCUMENTS:</u></i>  Passenger(s) assumes sole responsibility to independently confirm all documentation requirements for all passport, visa, vaccination, or other entry and/or travel requirements of each destination. Passenger(s) assumes sole responsibility for, and hereby releases BIT from any claims or responsibility for any and all damages incurred as a result of Passenger(s) failure to comply with applicable documentation requirements, including but not limited the requirement that all Passengers procure, and have on their person the proper travel documents at all times. BIT recommends the Passenger(s) consult with the appropriate domestic and foreign governmental agencies for the current document requirements.</p>

                <p><i><u>PAYMENTS:</u></i> BIT accepts Visa, American Express, Discover, and Mastercard.  BIT holds reservations until "Deposit Due Date" indicated on your confirmation. If deposit/payment is not received by BIT on or before the Deposit Due Date, reservations are automatically cancelled. Failure to remit payments on a timely basis will automatically put your booking at risk of cancellation. Please contact us immediately, and in advance of your payment due date, if you will be unable to meet this obligation. Without limitation, Passenger(s) voluntarily hold BIT harmless for cancellation of any booking for either late payment or declination of a credit card.</p>
            </div>           
        </div>
    </div>
    <!-- 详情 end -->

    <!--引入头部-->
    <div id="footer"></div>
        <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="js/jquery-3.3.1.js"></script>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="js/bootstrap.min.js"></script>
    <!--导入布局js，共享header和footer-->
    <script type="text/javascript" src="js/include.js"></script>
    <script>
    $(document).ready(function() {
        rollImg();
    });
    
    function rollImg() {
        //焦点图效果
        //点击图片切换图片
        $('.little_img').on('mousemove', function() {
            $('.little_img').removeClass('cur_img');
            var big_pic = $(this).data('bigpic');
            $('.big_img').attr('src', big_pic);
            $(this).addClass('cur_img');
        });
        //上下切换
        var picindex = 0;
        var nextindex = 4;
        $('.down_img').on('click',function(){
            var num = $('.little_img').length;
            if((nextindex + 1) <= num){
                $('.little_img:eq('+picindex+')').hide();
                $('.little_img:eq('+nextindex+')').show();
                picindex = picindex + 1;
                nextindex = nextindex + 1;
            }
        });
        $('.up_img').on('click',function(){
            var num = $('.little_img').length;
            if(picindex > 0){
                $('.little_img:eq('+(nextindex-1)+')').hide();
                $('.little_img:eq('+(picindex-1)+')').show();
                picindex = picindex - 1;
                nextindex = nextindex - 1;
            }
        });
        //自动播放
        var timer = setInterval("auto_play()", 5000);
    }

    //自动轮播方法
    function auto_play() {
        var cur_index = $('.prosum_left dd').find('a.cur_img').index();
        cur_index = cur_index - 1;
        var num = $('.little_img').length;
        var max_index = 3;
        if ((num - 1) < 3) {
            max_index = num - 1;
        }
        if (cur_index < max_index) {
            var next_index = cur_index + 1;
            var big_pic = $('.little_img:eq(' + next_index + ')').data('bigpic');
            $('.little_img').removeClass('cur_img');
            $('.little_img:eq(' + next_index + ')').addClass('cur_img');
            $('.big_img').attr('src', big_pic);
        } else {
            var big_pic = $('.little_img:eq(0)').data('bigpic');
            $('.little_img').removeClass('cur_img');
            $('.little_img:eq(0)').addClass('cur_img');
            $('.big_img').attr('src', big_pic);
        }
    }

    $(function () {
        var rid = getParameter("rid");
        $.get("route/routeDetail",{rid:rid},function (route) {
            //https://www.sojson.com/ parse json data
            $("#rname").html(route.rname);
            $("#sname").html(route.seller.sname);
            $("#consphone").html(route.seller.consphone);
            $("#address").html(route.seller.address);
            $("#price").html("¥" + route.price);
            $("#routeIntroduce").html(route.routeIntroduce);
            $("#intro_title").html(route.rname);
            $("#favCount").html("已收藏"+ route.count +"次");

            $.get("category/find",{cid:route.cid},function (category) {
                $("#cname").html(category.cname);
                $("#cname").attr("href","route_list.html?cid="+route.cid);
            },"json")

            //img Carousel
            var dd_str = '<a class="up_img up_img_disable"></a>';
            for (var i = 0; i < route.routeImgList.length; i++) {
                var a_str;
                if (i >= 4) {
                    a_str = '<a title="" class="little_img" data-bigpic="'+ route.routeImgList[i].bigPic +'" style="display:none;">\n' +
                        '            <img src="'+ route.routeImgList[i].smallPic +'">\n' +
                        '       </a>';
                } else {
                    a_str = '<a title="" class="little_img" data-bigpic="'+ route.routeImgList[i].bigPic +'"">\n' +
                        '            <img src="'+ route.routeImgList[i].smallPic +'">\n' +
                        '       </a>';
                }
                dd_str += a_str;
            }

            dd_str += '<a class="down_img down_img_disable" style="margin-bottom: 0;"></a>'
            $("#carousel").html(dd_str);
            rollImg();
        },"json")
    });

    $(function () {
        var rid = getParameter("rid");
        $.get("route/isFavorite",{rid:rid},function (flag) {
            if (flag=="true") {
                //login user has add it to favorite
                $("#favorite").addClass("btn already");
                $("#favorite").attr("disabled","disabled");
                //alert(flag=="true"); //true
                $("#favorite").removeAttr("onclick");


            } else {
                $("#addText").html("点击收藏");
            }
        })
    })

    //click addFavorite button event
    function addFavorite() {
        var rid = getParameter("rid");
        $.get("user/findUser",{},function (user) {
            if (user!="null") {
                $.get("route/addFavorite",{rid:rid},function () {
                    location.reload();

                })
            } else {
                alert("Please login first!");
                location.href = "login.html";
            }
        })
    }
    </script>
</body>

</html>